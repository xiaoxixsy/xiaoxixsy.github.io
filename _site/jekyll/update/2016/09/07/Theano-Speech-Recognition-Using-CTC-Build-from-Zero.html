<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Build a CTC Network on Theano for Speech Recognition from Scratch (Unfinished) </title>
  <meta name="description" content="In this blog, I will tell you the process of my setup of a CTC enabled CNN-LSTM hybrid neural network on the top of Theano. I will show you the essential par...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://atlantix.com/jekyll/update/2016/09/07/Theano-Speech-Recognition-Using-CTC-Build-from-Zero.html">
  <link rel="alternate" type="application/rss+xml" title="Jianjing Xu's Blog" href="http://atlantix.com/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Jianjing Xu's Blog</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Build a CTC Network on Theano for Speech Recognition from Scratch (Unfinished) </h1>
    <p class="post-meta"><time datetime="2016-09-07T17:03:23+08:00" itemprop="datePublished">Sep 7, 2016</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>In this blog, I will tell you the process of my setup of a CTC enabled CNN-LSTM hybrid neural network on the top of Theano. I will show you the essential part of implementation, skipping some data-relevant code. Full code may be available on my repository later.</p>

<h2 id="build-a-cnn-for-speech-recognition">Build a CNN for Speech Recognition</h2>
<p>To build a CNN for speech recognition have two difficulties:</p>

<ul>
  <li>How to adapt to different input length.</li>
  <li>How to transform network output to framewise prediction.</li>
</ul>

<p>I don’t know if I should or should not assume a fixed-length input. Most RNN-based sequence processor use input of the same length, otherwise batch training is impossible . They make it possible by padding input sequence to the same length while using <code class="highlighter-rouge">mask</code> to block padded information. Well, I know I am going to put recurrent layers on the top of CNN, so I don’t know if enabling non-fixed input length is useful in training. But in practical application, I think I should provide an elegant solution for varying input by enabling network with arbitrary input length.</p>

<p>So the first problem I want to solve is to build a CNN capable of arbitrary input length.</p>

<h3 id="a-forward-only-cnn">A forward-only CNN</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">MSoftmax</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">input</span><span class="p">,</span><span class="n">ifTimeDist</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ifTimeDist</span><span class="p">:</span>
            <span class="c"># scan is for time distributed computation.</span>
            <span class="c"># softmax and scan seems to ignore batch axis (0).</span>
            <span class="c"># input shape: (batch_size,128,401)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">softmax_output</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">softmax</span><span class="p">,</span><span class="n">sequences</span><span class="o">=</span><span class="p">[</span><span class="nb">input</span><span class="o">.</span><span class="n">dimshuffle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
            <span class="c"># self.pred works. result (batch_size,401,128) [i,j,:] sums to 1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">softmax_output</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MConv2D</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s">"""
    My 2D convolution layer. Responsible for forward building.
    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">input</span><span class="p">,</span><span class="n">filter_shape</span><span class="p">):</span>
        <span class="s">"""
        @param input tensor of input
        @param filter_shape 4-dim tuple (n_filters,channel,height,width)
        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="nb">input</span> <span class="o">=</span> <span class="nb">input</span>
        <span class="c"># Initialize weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_shape</span> <span class="o">=</span> <span class="n">filter_shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">init_conv_weight</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_shape</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_shape</span><span class="p">[:</span><span class="mi">1</span><span class="p">]),</span><span class="n">dtype</span><span class="o">=</span><span class="n">theano</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">floatX</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">dimshuffle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s">'x'</span><span class="p">,</span><span class="s">'x'</span><span class="p">)</span> <span class="o">+</span> <span class="n">conv2d</span><span class="p">(</span>
            <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span><span class="n">filters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">,</span><span class="n">filter_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_shape</span><span class="p">,</span>
            <span class="n">border_mode</span><span class="o">=</span><span class="s">'valid'</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MConvNet</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s">"""
    Give a forward expression of CNN.
    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">input</span><span class="p">,</span><span class="n">base_num</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span><span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">n_class</span><span class="o">=</span><span class="mi">39</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="nb">input</span> <span class="o">=</span> <span class="nb">input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_class</span> <span class="o">=</span> <span class="n">n_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv_shape</span> <span class="o">=</span> <span class="p">[(</span><span class="n">base_num</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">stride</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span>
        <span class="p">(</span><span class="n">base_num</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">base_num</span><span class="p">,</span><span class="n">stride</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span>
        <span class="p">(</span><span class="n">n_class</span><span class="p">,</span><span class="n">base_num</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">stride</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">conv_layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">MConv2D</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conv_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">MConv2D</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_layers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">out</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_shape</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>

        <span class="c"># final layer's shape:(batch_size,diminished_length,n_class,1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">out</span><span class="p">[:,:,:,</span><span class="mi">0</span><span class="p">]</span></code></pre></figure>

<p>Personally, I don’t know how to produce a framewise probability distribution elegantly. Now the only way that I came up with is to scan through all time steps… Maybe doing softmax along time axis shouldn’t bother to use scan ? I would be appreciative if you can tell me how to do.</p>

<p>Anyway, this code passed tests. If I build the network output as function and pass it some values, it will get a right-shaped output and some random number. Prediction layer will get each time step’s prediction for each example sums up to 1. Seems to be good : ).</p>

<h3 id="enable-training">Enable Training</h3>

<p>The next step is to enable CTC loss function. Here I just use keras CTC loss function. And the added lines is shown below:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="bp">self</span><span class="o">.</span><span class="n">raw_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">out</span><span class="p">[:,:,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="c"># we start from here</span>
<span class="bp">self</span><span class="o">.</span><span class="n">softmax_layer</span> <span class="o">=</span> <span class="n">MSoftmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_out</span><span class="p">,</span><span class="n">ifTimeDist</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">softmax_layer</span><span class="o">.</span><span class="n">softmax_output</span>

<span class="c"># CTC batch Loss layer construction</span>
<span class="bp">self</span><span class="o">.</span><span class="n">ctc_input_len</span> <span class="o">=</span> <span class="n">input_length</span>
<span class="bp">self</span><span class="o">.</span><span class="n">ctc_label_len</span> <span class="o">=</span> <span class="n">label_length</span>
<span class="bp">self</span><span class="o">.</span><span class="n">ctc_label</span> <span class="o">=</span> <span class="n">ctc_labels</span>
<span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">K</span><span class="o">.</span><span class="n">ctc_batch_cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctc_label</span><span class="p">,</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">pred</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ctc_input_len</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ctc_label_len</span><span class="p">)</span> <span class="p">)</span>

<span class="c"># Prepare For Differentiation</span>
<span class="bp">self</span><span class="o">.</span><span class="n">input_vars</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="nb">input</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ctc_label</span><span class="p">,</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">ctc_input_len</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ctc_label_len</span> <span class="p">]</span>

<span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span><span class="o">.</span><span class="n">W</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv_layers</span><span class="p">]</span>
<span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="n">layer</span><span class="o">.</span><span class="n">b</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv_layers</span><span class="p">]</span></code></pre></figure>

<p>There is a small tactic: use <code class="highlighter-rouge">T.mean</code>. Other wise you will get a loss for each examples in a batch, while cost must be a scalar. If you test the <code class="highlighter-rouge">loss</code> as network function’s output, you will get a number around 1400, which is also the loss if you train a CTC network using keras approximately. By the way, you should set the variables like this:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="n">train_x</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">ftensor4</span><span class="p">(</span><span class="s">"train_x"</span><span class="p">)</span>
<span class="n">input_length</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="s">"CTC_Input_Length"</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s">"int32"</span><span class="p">)</span> <span class="c"># notice: matrix rather than vector</span>
<span class="n">label_length</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="s">"Label_Length"</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s">"int32"</span><span class="p">)</span> <span class="c"># notice: matrix rather than vector</span>
<span class="n">ctc_labels</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="s">"CTC_Labels"</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s">"int32"</span><span class="p">)</span>
<span class="n">Net</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">MConvNet</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">ctc_labels</span><span class="p">,</span><span class="n">input_length</span><span class="p">,</span><span class="n">label_length</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

<span class="c"># for testing loss functions</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">bi</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">batch_size</span>
<span class="n">ei</span> <span class="o">=</span> <span class="n">bi</span> <span class="o">+</span> <span class="n">batch_size</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">feature</span><span class="p">[</span><span class="n">bi</span><span class="p">:</span><span class="n">ei</span><span class="p">,:,:,:]</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span><span class="n">maxil</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="s">"int32"</span><span class="p">)</span>
<span class="n">len_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">bi</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ei</span><span class="o">-</span><span class="n">bi</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="s">"int32"</span><span class="p">)</span>
<span class="n">len_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">399</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)],</span><span class="n">dtype</span><span class="o">=</span><span class="s">"int32"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span>
    <span class="n">train_y</span><span class="p">[</span><span class="n">j</span><span class="p">,:</span><span class="n">len_y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="p">]</span> <span class="o">=</span> <span class="n">sent</span><span class="p">[</span><span class="n">bi</span><span class="o">+</span><span class="n">j</span><span class="p">][:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">"int32"</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">Net</span><span class="o">.</span><span class="n">loss</span><span class="o">.</span><span class="nb">eval</span><span class="p">(</span> <span class="p">{</span><span class="n">train_x</span><span class="p">:</span><span class="n">train_data</span><span class="p">,</span>
    <span class="n">ctc_labels</span><span class="p">:</span><span class="n">train_y</span><span class="p">,</span>
    <span class="n">label_length</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">len_y</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">input_length</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">len_pred</span><span class="p">,</span><span class="mi">1</span><span class="p">)})</span></code></pre></figure>

<p>Well you may notice in the loss function testing part, you cannot do as I suggest. Because I am experimenting on TIMIT dataset and I have transformed the dataset. So it is of no use even if I post the entire code : ). Here I am just showing you the core implementation of a CTC network.</p>

<p>Now we are going to differentiate the network. In this step, I apply <code class="highlighter-rouge">Adadelta</code> and reuse <code class="highlighter-rouge">Deep Learning Tutorial's lstm.py</code>. I wrap the process of compilation into a class, to which I may add more optimizers. ( Am I going to write a ,eh.., another keras in the future? )</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="k">class</span> <span class="nc">NetworkCompiler</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s">"""
    Compile the network given optimizer and theano model
    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'Adadelta'</span><span class="p">):</span>
        <span class="s">"""
        @param model Theano model
        @param optimizer 'Adam' 'Adadelta' 'SGD' ...
        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="k">if</span> <span class="n">optimizer</span> <span class="o">==</span> <span class="s">'Adadelta'</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grad_func</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">update_func</span> <span class="o">=</span> <span class="n">adadelta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">input_vars</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">loss</span><span class="p">)</span></code></pre></figure>

<p>Personally I am really confused with the original <code class="highlighter-rouge">Adadelta</code>code. Schematically, this function produces two functions:</p>

<ul>
  <li>f_grad_shared: Takes in all inputs, produce an output, and prepare the update values.</li>
  <li>f_update: do updates (apply update values to parameters)</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">adadelta</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">tparams</span><span class="p">,</span> <span class="n">grads</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cost</span><span class="p">):</span>
    <span class="s">"""
    lr : Theano SharedVariable
        Initial learning rate
    tpramas: Theano SharedVariable
        Model parameters
    grads: Theano variable
        Gradients of cost w.r.t to parameters
    x: Theano variable
        Model inputs
    mask: Theano variable
        Sequence mask
    y: Theano variable
        Targets
    cost: Theano variable
        Objective fucntion to minimize
    """</span>

    <span class="n">zipped_grads</span> <span class="o">=</span> <span class="p">[</span><span class="n">theano</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">*</span> <span class="n">numpy_floatX</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s">'</span><span class="si">%</span><span class="s">s_grad'</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tparams</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="n">running_up2</span> <span class="o">=</span> <span class="p">[</span><span class="n">theano</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">*</span> <span class="n">numpy_floatX</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s">'</span><span class="si">%</span><span class="s">s_rup2'</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tparams</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="n">running_grads2</span> <span class="o">=</span> <span class="p">[</span><span class="n">theano</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">*</span> <span class="n">numpy_floatX</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s">'</span><span class="si">%</span><span class="s">s_rgrad2'</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tparams</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

    <span class="n">zgup</span> <span class="o">=</span> <span class="p">[(</span><span class="n">zg</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">zg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">zipped_grads</span><span class="p">,</span> <span class="n">grads</span><span class="p">)]</span>
    <span class="n">rg2up</span> <span class="o">=</span> <span class="p">[(</span><span class="n">rg2</span><span class="p">,</span> <span class="mf">0.95</span> <span class="o">*</span> <span class="n">rg2</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">g</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
             <span class="k">for</span> <span class="n">rg2</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">running_grads2</span><span class="p">,</span> <span class="n">grads</span><span class="p">)]</span>

    <span class="n">f_grad_shared</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">function</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">cost</span><span class="p">,</span> <span class="n">updates</span><span class="o">=</span><span class="n">zgup</span> <span class="o">+</span> <span class="n">rg2up</span><span class="p">,</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s">'adadelta_f_grad_shared'</span><span class="p">)</span>

    <span class="n">updir</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">tensor</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ru2</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span> <span class="o">/</span> <span class="n">tensor</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rg2</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span> <span class="o">*</span> <span class="n">zg</span>
             <span class="k">for</span> <span class="n">zg</span><span class="p">,</span> <span class="n">ru2</span><span class="p">,</span> <span class="n">rg2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">zipped_grads</span><span class="p">,</span>
                                     <span class="n">running_up2</span><span class="p">,</span>
                                     <span class="n">running_grads2</span><span class="p">)]</span>
    <span class="n">ru2up</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ru2</span><span class="p">,</span> <span class="mf">0.95</span> <span class="o">*</span> <span class="n">ru2</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">ud</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
             <span class="k">for</span> <span class="n">ru2</span><span class="p">,</span> <span class="n">ud</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">running_up2</span><span class="p">,</span> <span class="n">updir</span><span class="p">)]</span>
    <span class="n">param_up</span> <span class="o">=</span> <span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="n">ud</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">ud</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tparams</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">updir</span><span class="p">)]</span>

    <span class="n">f_update</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">function</span><span class="p">([</span><span class="n">lr</span><span class="p">],</span> <span class="p">[],</span> <span class="n">updates</span><span class="o">=</span><span class="n">ru2up</span> <span class="o">+</span> <span class="n">param_up</span><span class="p">,</span>
                               <span class="n">on_unused_input</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">,</span>
                               <span class="n">name</span><span class="o">=</span><span class="s">'adadelta_f_update'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">f_grad_shared</span><span class="p">,</span> <span class="n">f_update</span></code></pre></figure>

<p>But I am rather confused in two ways:</p>

<ul>
  <li>tparams is not theano variable but dictionary instead</li>
  <li>does lr has any effect? What’s more, I think <code class="highlighter-rouge">Adadelta</code> prefers lr to be set to 1, having nothing to do with learning rate scheduling.</li>
</ul>

<p>Again, please tell me if you know why : ) .</p>

<p>Here is my modified version. Modification includes:</p>

<ul>
  <li>Switch dictionary parameter to ordinary theano shared variable parameter.</li>
  <li>Enable multiple inputs by using a list of shared varibles.</li>
  <li>Removed <code class="highlighter-rouge">lr</code>.</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">adadelta</span><span class="p">(</span><span class="n">tparams</span><span class="p">,</span><span class="n">inputs</span><span class="p">,</span> <span class="n">cost</span><span class="p">):</span>
    <span class="s">"""
    tpramas: Theano SharedVariable
        Model parameters
    inputs: list of inputs (including x &amp; y)
    cost: Theano variable
        Objective fucntion to minimize
    """</span>
    <span class="n">grads</span> <span class="o">=</span> <span class="p">[</span><span class="n">T</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span><span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">tparams</span><span class="p">]</span>

    <span class="n">zipped_grads</span> <span class="o">=</span> <span class="p">[</span><span class="n">theano</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">*</span> <span class="n">numpy_floatX</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tparams</span><span class="p">]</span>
    <span class="n">running_up2</span> <span class="o">=</span> <span class="p">[</span><span class="n">theano</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">*</span> <span class="n">numpy_floatX</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="p">)</span>
                   <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tparams</span><span class="p">]</span>
    <span class="n">running_grads2</span> <span class="o">=</span> <span class="p">[</span><span class="n">theano</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span> <span class="o">*</span> <span class="n">numpy_floatX</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tparams</span><span class="p">]</span>

    <span class="n">zgup</span> <span class="o">=</span> <span class="p">[(</span><span class="n">zg</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">zg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">zipped_grads</span><span class="p">,</span> <span class="n">grads</span><span class="p">)]</span>
    <span class="n">rg2up</span> <span class="o">=</span> <span class="p">[(</span><span class="n">rg2</span><span class="p">,</span> <span class="mf">0.95</span> <span class="o">*</span> <span class="n">rg2</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">g</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
             <span class="k">for</span> <span class="n">rg2</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">running_grads2</span><span class="p">,</span> <span class="n">grads</span><span class="p">)]</span>

    <span class="n">f_grad_shared</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">updates</span><span class="o">=</span><span class="n">zgup</span> <span class="o">+</span> <span class="n">rg2up</span><span class="p">)</span>

    <span class="n">updir</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">T</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ru2</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rg2</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span> <span class="o">*</span> <span class="n">zg</span>
             <span class="k">for</span> <span class="n">zg</span><span class="p">,</span> <span class="n">ru2</span><span class="p">,</span> <span class="n">rg2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">zipped_grads</span><span class="p">,</span>
                                     <span class="n">running_up2</span><span class="p">,</span>
                                     <span class="n">running_grads2</span><span class="p">)]</span>
    <span class="n">ru2up</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ru2</span><span class="p">,</span> <span class="mf">0.95</span> <span class="o">*</span> <span class="n">ru2</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">ud</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
             <span class="k">for</span> <span class="n">ru2</span><span class="p">,</span> <span class="n">ud</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">running_up2</span><span class="p">,</span> <span class="n">updir</span><span class="p">)]</span>
    <span class="n">param_up</span> <span class="o">=</span> <span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="n">ud</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">ud</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tparams</span><span class="p">,</span> <span class="n">updir</span><span class="p">)]</span>

    <span class="n">f_update</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">function</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">updates</span><span class="o">=</span><span class="n">ru2up</span> <span class="o">+</span> <span class="n">param_up</span><span class="p">,</span>
                               <span class="n">on_unused_input</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">,</span>
                               <span class="n">name</span><span class="o">=</span><span class="s">'adadelta_f_update'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">f_grad_shared</span><span class="p">,</span> <span class="n">f_update</span></code></pre></figure>

<p>Anyway, this compiles. Now it comes to train the network. To obtain a more tractable training procedure, I wrote a class <code class="highlighter-rouge">BatchTrainingScheduler</code>, responsible for preparing batch data, training and saving weights. Again, this evolves much unnecessary details, so I skip the implementation here.</p>

<p>In addition, I added framewise loss for comparation. This requires a new layer implementation:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">MCrossEntropyFromSoftmax</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">softmax_output</span><span class="p">,</span><span class="n">label_prob</span><span class="p">,</span><span class="n">ifTimeDist</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ifTimeDist</span><span class="p">:</span>
            <span class="c"># softmax_output is expect to be (batch,401,128)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame_log</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">log</span><span class="p">,</span><span class="n">sequences</span><span class="o">=</span><span class="p">[</span><span class="n">softmax_output</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame_loss</span> <span class="o">=</span> <span class="o">-</span> <span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">T</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span> <span class="n">label_prob</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_log</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c"># loss shape : (401)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame_loss</span> <span class="o">=</span> <span class="o">-</span> <span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">label_prob</span> <span class="o">*</span> <span class="n">T</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">softmax_output</span><span class="p">))</span></code></pre></figure>

<p>Now the CTC-CNN runs.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">Using</span> <span class="n">gpu</span> <span class="n">device</span> <span class="mi">2</span><span class="p">:</span> <span class="n">GeForce</span> <span class="n">GTX</span> <span class="n">TITAN</span> <span class="n">X</span> <span class="p">(</span><span class="n">CNMeM</span> <span class="ow">is</span> <span class="n">disabled</span><span class="p">,</span> <span class="n">cuDNN</span> <span class="ow">not</span> <span class="n">available</span><span class="p">)</span>
<span class="n">Using</span> <span class="n">Theano</span> <span class="n">backend</span><span class="o">.</span>
<span class="n">Loading</span> <span class="n">Training</span> <span class="n">Data</span><span class="p">:</span>
<span class="p">(</span><span class="s">'./data/CoreTest_Audio_3.npy'</span><span class="p">,</span> <span class="s">'./data/CoreTest_Label_3.npy'</span><span class="p">,</span> <span class="s">'./data/CoreTest_Sentence_3.npy'</span><span class="p">)</span>
<span class="n">Dataset</span> <span class="n">loading</span> <span class="n">compelte</span><span class="o">.</span>
<span class="n">Max</span> <span class="n">Frame</span><span class="p">:</span> <span class="mi">405</span> 	 <span class="n">Max</span> <span class="n">Sequence</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">67</span>
<span class="n">Label</span> <span class="n">length</span><span class="p">:</span> <span class="mi">399</span>
<span class="n">Building</span> <span class="n">Model</span>
<span class="n">Using</span> <span class="n">base</span> <span class="n">convolution</span> <span class="nb">filter</span><span class="p">:</span> <span class="bp">None</span>
<span class="n">Model</span> <span class="n">name</span><span class="p">:</span> <span class="n">THEANO</span>
<span class="n">Building</span> <span class="n">model</span><span class="o">...</span>
<span class="n">Compiling</span> <span class="k">for</span> <span class="n">CTC</span><span class="o">...</span>
<span class="p">[</span><span class="n">audio_input</span><span class="p">,</span> <span class="n">CTC_Labels</span><span class="p">,</span> <span class="n">CTC_Input_Length</span><span class="p">,</span> <span class="n">Label_Length</span><span class="p">]</span>
<span class="n">Compiling</span> <span class="k">for</span> <span class="n">Framewise</span> <span class="n">Prediction</span><span class="o">...</span>
<span class="p">[</span><span class="n">audio_input</span><span class="p">,</span> <span class="n">audio_label</span><span class="p">]</span>
<span class="n">Checking</span> <span class="n">Network</span> <span class="n">Output</span><span class="o">...</span>
<span class="p">(</span><span class="mi">399</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">Checking</span> <span class="n">Frame</span> <span class="n">Loss</span><span class="o">...</span>
<span class="mf">3.68886995316</span>
<span class="n">Checking</span> <span class="n">CTC</span> <span class="n">Loss</span><span class="o">...</span>
<span class="n">Train</span> <span class="n">using</span> <span class="n">CTC</span> <span class="n">loss</span> <span class="o">...</span>
<span class="mf">1266.20937281</span>
<span class="mf">1266.20937281</span>
<span class="mf">1280.3120997</span>
<span class="mf">1084.664638</span>
<span class="mf">786.608295334</span>
<span class="mf">712.46418894</span>
<span class="mf">708.009468547</span>
<span class="mf">709.193808295</span>
<span class="mf">699.881733037</span>
<span class="mf">683.349069459</span>
<span class="mf">678.93139635</span>
<span class="mf">679.363749416</span>
<span class="mf">679.713211679</span>
<span class="n">Train</span> <span class="n">using</span> <span class="n">Framewise</span> <span class="n">Loss</span><span class="o">...</span>
<span class="mf">3.82449817657</span>
<span class="mf">3.77304577827</span>
<span class="mf">3.27461051941</span>
<span class="mf">2.84103941917</span>
<span class="mf">2.87398314476</span>
<span class="mf">2.90601921082</span>
<span class="mf">2.94813394547</span>
<span class="mf">2.85982584953</span>
<span class="mf">2.88489484787</span>
<span class="mf">2.98423242569</span>
<span class="mf">2.90129828453</span>
<span class="mf">2.98246645927</span>
<span class="n">Train</span> <span class="n">using</span> <span class="n">CTC</span> <span class="n">Loss</span><span class="o">...</span>
<span class="mf">696.61584301</span>
<span class="mf">695.274994058</span>
<span class="mf">695.945729375</span>
<span class="mf">701.028371696</span>
<span class="mf">698.802302323</span>
<span class="o">...</span></code></pre></figure>

<p>Aha, things goes fine. Em.. Don’t you think training with two loss function is great?</p>

<h2 id="adding-lstm-">Adding LSTM !</h2>

  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Jianjing Xu's Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Jianjing Xu's Blog</li>
          <li><a href="mailto:xujj15@mails.tsinghua.edu.cn">xujj15@mails.tsinghua.edu.cn</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/AtlantixJJ"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">AtlantixJJ</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/Non"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">Non</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Some day my AI will help me write the blogs...
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
